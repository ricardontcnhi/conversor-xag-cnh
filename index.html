<!DOCTYPE html><html lang='pt-BR'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>Conversor Chassi XAG > CNH</title>
<meta name="theme-color" content="#0066cc">
<link rel="manifest" href="manifest.json">
<style>
  /* 1) EVITA que inputs saiam do card (o principal da correção) */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body { margin:0; font-family:Arial; background:#f0f2f5; color:#222; }

  .header{
    background:#0066cc; color:white; padding:20px; text-align:center;
    font-size:24px; font-weight:bold; box-shadow:0 2px 5px rgba(0,0,0,0.2);
  }

  /* 2) Centraliza e limita a largura para evitar “espremer” em telas largas */
  .container{
    padding:20px;
    max-width: 920px;       /* opcional, para estética */
    margin: 0 auto;         /* centraliza */
  }

  .card{
    background:white; border-radius:12px; padding:20px; margin-bottom:20px;
    box-shadow:0 2px 6px rgba(0,0,0,0.15);
  }

  label{ font-size:16px; font-weight:bold; margin-top:10px; display:block; }

  /* 3) Garante largura exata do card mesmo com padding/border */
  input, select {
    width:100%; padding:15px; border-radius:8px; border:1px solid #ccc;
    margin-top:5px; font-size:16px; display:block;
  }

  button{
    width:100%; background:#0066cc; color:white; border:none; padding:15px;
    border-radius:8px; font-size:18px; margin-top:20px; cursor:pointer;
  }
  button:hover{ background:#0055aa; }

  .copyBtn{ background:#00aa55 !important; }

  #output{ margin-top:15px; font-size:20px; font-weight:bold; color:green; text-align:center; }

  .footer{ text-align:center; font-size:14px; color:#555; margin-top:20px; margin-bottom:20px; }

  .steps{ font-size:16px; line-height:1.6; }
  .steps li{ margin-bottom:12px; }
</style>
<script>
// --------------------- Tabela VIN (10º dígito) para ANO-MODELO ---------------------
// Ciclo padrão: A..Y, depois 1..9, e reinicia. (2000–2039 listados aqui)
const VIN_YEAR_CODE = {
  2000:'Y', 2001:'1', 2002:'2', 2003:'3', 2004:'4', 2005:'5', 2006:'6',
  2007:'7', 2008:'8', 2009:'9', 2010:'A', 2011:'B', 2012:'C', 2013:'D',
  2014:'E', 2015:'F', 2016:'G', 2017:'H', 2018:'J', 2019:'K',
  2020:'L', 2021:'M', 2022:'N', 2023:'P', 2024:'R', 2025:'S', 2026:'T',
  2027:'V', 2028:'W', 2029:'X', 2030:'Y', 2031:'1', 2032:'2', 2033:'3',
  2034:'4', 2035:'5', 2036:'6', 2037:'7', 2038:'8', 2039:'9'
};

// --------------------- Preenche o <select> de ano-modelo ---------------------
(function fillAnoModelo(){
  const sel = document.getElementById('anoModelo');
  const anos = [];
  for (let y = 2015; y <= 2036; y++) anos.push(y); // ajuste o range se quiser
  sel.innerHTML = '<option value="">Selecione...</option>' +
                  anos.map(y => `<option value="${y}">${y}</option>`).join('');
})();

// (Opcional) Seleciona automaticamente o ano corrente, se existir no range
(function selectCurrentYear(){
  const sel = document.getElementById('anoModelo');
  const y = new Date().getFullYear();
  if (sel.querySelector(`option[value="${y}"]`)) sel.value = String(y);
})();

// --------------------- Helpers ---------------------
function vinCodeFromModelYear(year) {
  const y = Number(year);
  if (!VIN_YEAR_CODE[y]) throw new Error('Ano‑modelo fora da tabela suportada.');
  return VIN_YEAR_CODE[y];
}
function lastDigitOfYear(year) { return String(year).slice(-1); }

// --------------------- Conversor principal ---------------------
function converter(){
  const x = document.getElementById('xag').value.trim();
  const marca = document.getElementById('marca').value;
  const kit   = document.getElementById('kit').value;
  const anoModelo = document.getElementById('anoModelo').value;

  // Validações
  if (x.length < 18){ alert('Chassi XAG inválido'); return; }
  if (!anoModelo){ alert('Selecione o ano‑modelo'); return; }

  // Brand N/C
  const b = (marca === 'New Holland') ? 'N' : 'C';

  // Kit B/F (ajuste caso use S também)
  const c = (kit === 'Basic') ? 'B' : 'F';

  // ----- BLOCO dinâmico (substitui o "S4"): [letra VIN do ano‑modelo] + [último dígito do ano‑modelo]
  const letraAno = vinCodeFromModelYear(anoModelo);  // ex.: 2024 -> R
  const digitoAnoModelo = lastDigitOfYear(anoModelo); // ex.: 2024 -> 4
  const blocoVariante = letraAno + digitoAnoModelo;   // ex.: R4

  // ----- Partes do XAG: ano/semana/random
  // Observação: você pediu "ANO do XAG" a partir do caractere na POSIÇÃO 13.
  // Em strings JS (0-based), isso é charAt(12). (Antes você usava substring(12,13).)
  const anoXAG    = x.substring(12,13); // ou: x.charAt(12)
  const semanaXAG = x.substring(13,15);
  const randomXAG = x.substring(15);

  // ----- Montagem CNH
  // X + 24 + (N/C) + (P1/P2) + (B/F) + [blocoVariante] + anoXAG + semanaXAG + randomXAG
  const r = 'X' +
            x.substring(4,6) +    // product code (24)
            b +
            x.substring(6,8) +    // P1 / P2
            c +
            blocoVariante +       // <-- entra aqui no lugar do "S4"
            anoXAG +              // caractere 13 do XAG
            semanaXAG +
            randomXAG;

  // Exibe + botão copiar
  document.getElementById('output').innerText = r;
  const btn = document.getElementById('copyBtn');
  btn.style.display = 'block';
  btn.onclick = function(){
    navigator.clipboard.writeText(r)
      .then(()=>{ alert('Chassi CNH copiado!'); })
      .catch(()=>{ alert('Erro ao copiar'); });
  };
}

// Mantém o service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>
</head>
<body>
<div class='header'>Conversor Chassi XAG > CNH</div>
<div class='container'>
<div class='card'>
<h3>Conversor</h3>
<label>Chassi XAG:</label>
<input id='xag' placeholder='Digite o chassi XAG'>
<label>Marca:</label>
<select id='marca'><option>New Holland</option><option>Case</option></select>
<label>Kit:</label>
<select id='kit'><option>Basic</option><option>Full</option></select>
<label>Modelo:</label>
<select id="anoModelo"></select>
<button onclick='converter()'>Gerar Chassi CNH</button>
<div id='output'></div>
<button id='copyBtn' class='copyBtn' style='display:none;'>Copiar CNH</button>
</div>
<div class='card'>
<h3>Como adicionar como App no Celular</h3>
<ol class='steps'>
<li>Abra este site no navegador Chrome do celular.</li>
<li>Aguarde aparecer o aviso: <b>“Adicionar à tela inicial”</b>.</li>
<li>Se não aparecer, toque nos três pontinhos (⋮) do Chrome.</li>
<li>Toque em <b>Adicionar à tela inicial</b>.</li>
<li>Confirme e o WebAPK será instalado como aplicativo real.</li>
</ol>
</div>
<div class='card'>
<h3>Como instalar no Computador</h3>
<ol class='steps'>
<li>Abra o site no Chrome (Windows/Mac).</li>
<li>Clique no ícone de instalação na barra de endereço (um monitor com setinha).</li>
<li>Confirme em <b>Instalar</b>.</li>
<li>O app será instalado como programa independente.</li>
</ol>
</div>
<div class='footer'>Centro de Treinamento Curitiba - 12/02/2026 - RNT</div>
</div>
</body></html>
